## S610 Final Project
library(readr)
dubliners <- read_file("http://www.gutenberg.org/files/2814/old/dblnr11.txt")

next_word <- function(corpus) {
  corp_vector <- unlist(strsplit(corpus, 
                                 "\\, | |\\. |\\? |\\! |\" | \"|\' | \'| (|) | [|] |  |  "))
  t_matrix <- build_matrix(corp_vector)
  t_matrix
}

build_matrix <- function(words_vec) {
  unique_words <- unique(words_vec)
  tmatrix_unique_words <- data.frame(matrix(nrow = length(unique_words),
                                            ncol = length(unique_words)),
                                     row.names = unique_words)
  colnames(tmatrix_unique_words) <- unique_words
  
  for(i in 1:length(unique_words)){
    subsequent_words_i <- which(words_vec == unique_words[i])+1
    subsequent_words <- words_vec[subsequent_words_i]
    unique_sub_words <- unique(subsequent_words)

    sub_word_count <- rep(list(0), length(unique_words))
    
    for (k in 1:length(unique_sub_words)){
      unique_sub_words_i <- which(unique_words == unique_sub_words[k])
      if (length(unique_sub_words_i) != 0){
        sub_word_count[[unique_sub_words_i]] <- sum(subsequent_words == unique_sub_words[k])
      }
    }
    tmatrix_unique_words[i,] <- unlist(sub_word_count)
    tmatrix_unique_words[i,] <- tmatrix_unique_words[i,]*(1/sum(tmatrix_unique_words[i,]))
  }
  return(tmatrix_unique_words)
}

test_a <- next_word("The earliest reference to pneumatic transmission of which we find any record is a paper presented to the Royal Society of London, by Denis Papin, in the year 1667, entitled "Double Pneumatic Pump." His plan was to exhaust the air from a long metal tube by two large cylinders. The tube was to contain a piston, to which a carriage was attached by means of a cord. The "American Cyclopædia" goes on to say, "More than a century elapsed before any further effort in this direction was made. Paucbrouke's 'Dictionnaire Encyclopédique des Amusements des Sciences' (1792) gives a description of a machine by M. Van Estin, by means of which a hollow ball holding a small package was propelled by a blast of air through a tube several hundred feet in length, and having many curves. This plan seems, however, to have been more an amusement than an attempt to introduce an industrial scheme. With more regard to practical results, Medhurst, an engineer of London, published a pamphlet on the subject in 1810. He proposed to move10 small carriages on rails in air-tight tubes or tunnels, by compressed air behind, or by creating a partial vacuum in front. In 1812 he published another pamphlet; but the plan was not put into successful operation, principally from insufficient means of exhaustion. About 1832 he proposed to connect the carriage inside such a tube with a passenger carriage running on the top of the tube; and, although the latter project has never been commercially successful, it was the first to be practically attempted. More than a score of patents were taken out on the Continent and in England and America, none of which met with any practical success. Returning to the original idea of Denis Papin, inventors attempted to accomplish pneumatic transmission by moving the load inside the tube, and in course of time achieved success. In France MM. Jarroux and Taisseau presented a project for atmospheric telegraphy before the Academy of Sciences, and they were succeeded in the same direction by MM. Brochet and Ardor."
Practical Beginning of the Art. The London Pneumatic Telegraph.-London has the honor of being the first city to have a practical system of pneumatic telegraphy. The first tubes were installed by the Electric and International Telegraph Company, the work being planned and carried out by their engineer, Mr. Josiah Latimer Clark, in 1853 and 1854. The first tube to be laid was one and one-half inches in diameter, and extended from the central station, Founder's Court, Lothbury, to the Stock Exchange, Throgmorton Street, a distance of two hundred and twenty yards. The tube was operated intermittently by connecting it to a vacuum chamber at the11 central station. Carriers were sent only in one direction. A steam-pump was used to maintain the vacuum. Much experience was gained from the use of this first tube. In 1858 some improvements were made by Mr. C. F. Varley, and I can best describe them by quoting from the discussion of Mr. Carl Siemens's paper on "Pneumatic Despatch Tubes: The Circuit System" before the Institution of Civil Engineers, as recorded in the minutes of that society. "Later, about the year 1858, when a pipe two and one-fourth inches internal diameter was extended from Telegraph Street to Mincing Lane, thirteen hundred and forty yards in length, the traffic was so considerable that it was found desirable to have the power of sending messages in both directions. To effect that a smaller pipe, one and one-half inches in internal diameter, was laid between Telegraph Street and Mincing Lane, with a view to carrying the vacuum to the latter station, so as to take messages in the opposite direction. This smaller pipe was found to so wiredraw the current that the pipe would not work, the leakage past the carrier being too considerable; and accordingly a large chamber was built in the basement floor or kitchen at the corner of Mincing Lane and Leadenhall Street to collect power or vacuum for bringing the messages from Telegraph Street to Mincing Lane. This chamber was constructed of timber, fourteen feet by twelve feet broad and ten feet high, and was covered with lead. It was not strong enough to withstand the pressure; for one day, a carrier having stuck half-way, and when there was a higher vacuum than usual,-viz., twenty-three inches of mercury,-it collapsed with a loud report. At the time12 the landlord of the house happened to be dining in the next room, and he suddenly found himself, his table, dinner, and the door, which was wrenched off its hinges, precipitated into the room amongst the débris of the chamber. The windows were forced inwards, and those on the opposite side of Mincing Lane and Leadenhall Street were drawn outwards. The damage was considerable. This accident put an end, for a time, to the attempt to send telegraph messages by means of a vacuum conveyed through this smaller pipe. About that time he (Mr. Varley) became the engineer-in-chief of the Electric Telegraph Company, and got permission from the directors to introduce a new system,-viz., compressed air,-though many persons contended that it would be impossible to blow messages through a pipe, because all attempts to blow air through long pipes had utterly failed; while others said that, if messages were sent, they would go much slower than with the vacuum.... In his (Mr. Varley's) apparatus, for he was the first to introduce compressed air, the reverse was found to be the case, and for this reason: the tube did not consume power until a message was about to be forwarded; and in a tube thirteen hundred yards in length, and two and one-fourth inches in diameter, fifteen seconds elapsed before the vacuum was felt at the distant end after communication had been established with the exhausted chamber at the engine end of the tube, consequently the carrier did not start until after fifteen seconds had elapsed. When a message was sent by compressed air, it was sent from the end at which the power was applied, and the carrier started at once, thus gaining a start of fifteen13 seconds; now, inasmuch as the air in the tube had to be compressed, it started at a very high velocity, and when it reached the other end the compressed air in expanding gave it a higher velocity. The result was, in thirteen hundred and forty yards, from Telegraph Street to Mincing Lane, the carriers were drawn by vacuum, on an average, in from sixty to seventy seconds, and were propelled by compressed air in about fifty or fifty-five seconds, the difference of pressure in each case being nearly equal."
The first one and one-half inch tubes laid under the direction of Mr. Clark were of iron with screwed joints. They gave much trouble from roughness upon the interior, which wore the carriers very rapidly, and from water that was drawn in through leaky joints. When the extensions were made in 1858 and afterwards, two and one-fourth inch lead tubes were used with plumber's joints made over a heated mandrel, which made the joints very smooth upon the interior. The carriers were of gutta percha in the form of a cylinder closed at one end and fitted with a cap at the other. The outside was covered with felt or drugget.

When a carrier was to be despatched, a signal was sent to an attendant at the pump end of the tube, who closed that end and connected the tube to an exhausted chamber by opening a valve. As soon as the carrier arrived, he closed the valve and opened the tube, which allowed the carrier to drop out. Mr. Varley improved the method of operating the valves by making the air pressure do the work by means of cylinders and pistons when the attendant pressed a button. He also improved the carriers by doing14 away with the cap and using in its place an elastic band to hold the messages in place.

We have seen that Mr. Clark designed the first tube used in connection with the telegraph, and that it was a single tube, operated in one direction only by vacuum, being operated only when there were messages to send. This was extended and improved by Mr. Varley, who increased the diameter of the tubes from one and one-half inches to two and one-quarter inches, and operated them in both directions, using vacuum for sending in one direction and compressed air for sending in the other. The air current was maintained in the tubes only when messages were sent.")
 View(test_a)
 